// Mini Simulatore di Vita sull'Isola - Ispirato ad Animal Crossing
const simulatoreIsola = {
  // Stato del gioco
  stato: {
    giocatore: {
      nome: "Abitante",
      soldi: 1000,
      inventario: [],
      casa: {livello: 1, arredamento: []}
    },
    isola: {
      nome: "Isolafelice",
      residenti: ["Fuffi", "Lilli", "Bobo", "Mirtillo"],
      luoghi: ["Spiaggia", "Foresta", "Piazza", "Fiume", "Negozio"]
    },
    data: {
      giorno: 1,
      mese: 3,
      stagione: "Primavera",
      ora: 10
    },
    attivita: {
      pesca: ["Carpa", "Trota", "Pesce Rosso", "Pesce Palla", "Squalo"],
      insetti: ["Farfalla", "Coccinella", "Mantide", "Libellula", "Scarabeo"],
      frutti: ["Mela", "Pera", "Ciliegia", "Pesca", "Arancia"],
      fossili: ["Trilobite", "Ammonite", "T-Rex", "Stegosauro", "Mammut"]
    }
  },

  // Interfaccia utente
  inizia() {
    console.log(`âœ¨ Benvenuto a ${this.stato.isola.nome}! âœ¨`);
    console.log(`Oggi Ã¨ un bel giorno di ${this.stato.data.stagione}.`);
    this.mostraMenu();
  },

  mostraMenu() {
    console.log("\nðŸ“‹ MENU PRINCIPALE ðŸ“‹");
    console.log("1. Esplora l'isola");
    console.log("2. Parla con i residenti");
    console.log("3. Pesca o caccia insetti");
    console.log("4. Raccogli frutti o fossili");
    console.log("5. Visita il negozio");
    console.log("6. Arreda la tua casa");
    console.log("7. Avanza il tempo");
    console.log("8. Controlla il tuo stato");
    console.log("9. Salva ed esci");
    
    // In un'implementazione completa, qui gestiremmo l'input dell'utente
    console.log("\nUsa i numeri per selezionare un'opzione!");
  },

  esploraIsola() {
    const luogo = this.stato.isola.luoghi[Math.floor(Math.random() * this.stato.isola.luoghi.length)];
    console.log(`Stai esplorando: ${luogo}`);
    
    // PossibilitÃ  di trovare oggetti
    if (Math.random() > 0.6) {
      const oggettiPossibili = ["Bottiglia con messaggio", "Moneta", "Conchiglia rara", "Seme di fiore"];
      const oggetto = oggettiPossibili[Math.floor(Math.random() * oggettiPossibili.length)];
      console.log(`Hai trovato: ${oggetto}!`);
      this.stato.giocatore.inventario.push(oggetto);
    } else {
      console.log("Non hai trovato nulla di speciale qui.");
    }
  },

  parlaConResidenti() {
    const residente = this.stato.isola.residenti[Math.floor(Math.random() * this.stato.isola.residenti.length)];
    const dialoghi = [
      `Ciao ${this.stato.giocatore.nome}! Che bella giornata oggi, vero?`,
      `Ho sentito che il negozio ha nuovi oggetti oggi!`,
      `Mi piacerebbe ricevere un regalo... magari un pesce raro?`,
      `La mia casa ha bisogno di decorazioni. Hai consigli?`,
      `Ho trovato un fossile ieri! L'hai giÃ  visitato il museo?`
    ];
    
    const dialogo = dialoghi[Math.floor(Math.random() * dialoghi.length)];
    console.log(`${residente}: "${dialogo}"`);
    
    // PossibilitÃ  di ricevere regali
    if (Math.random() > 0.8) {
      const regaliPossibili = ["Dolce fatto in casa", "Lettera", "Fiore", "Frutto raro"];
      const regalo = regaliPossibili[Math.floor(Math.random() * regaliPossibili.length)];
      console.log(`${residente} ti ha regalato: ${regalo}!`);
      this.stato.giocatore.inventario.push(regalo);
    }
  },

  pescaOCacciaInsetti() {
    console.log("Vuoi pescare o cacciare insetti?");
    console.log("1. Pescare");
    console.log("2. Cacciare insetti");
    
    // Simuliamo la scelta della pesca
    const successo = Math.random() > 0.3;
    if (successo) {
      const pesce = this.stato.attivita.pesca[Math.floor(Math.random() * this.stato.attivita.pesca.length)];
      console.log(`Hai pescato un ${pesce}!`);
      this.stato.giocatore.inventario.push(pesce);
      this.stato.giocatore.soldi += 100;
      console.log("(+100 stelline)");
    } else {
      console.log("Oh no! Il pesce Ã¨ fuggito!");
    }
  },

  raccogliFruttiOFossili() {
    console.log("Vuoi raccogliere frutti o cercare fossili?");
    console.log("1. Raccogliere frutti");
    console.log("2. Cercare fossili");
    
    // Simuliamo la scelta della raccolta frutti
    const quantita = Math.floor(Math.random() * 3) + 1;
    const frutto = this.stato.attivita.frutti[Math.floor(Math.random() * this.stato.attivita.frutti.length)];
    console.log(`Hai raccolto ${quantita} ${frutto}!`);
    for (let i = 0; i < quantita; i++) {
      this.stato.giocatore.inventario.push(frutto);
    }
    this.stato.giocatore.soldi += quantita * 50;
    console.log(`(+${quantita * 50} stelline)`);
  },

  visitaNegozio() {
    console.log("Benvenuto al negozio! Ecco cosa puoi comprare oggi:");
    
    const oggettiInVendita = [
      {nome: "Sedia di legno", prezzo: 300},
      {nome: "Tavolo rustico", prezzo: 500},
      {nome: "Lampada a fungo", prezzo: 250},
      {nome: "Carta da parati floreale", prezzo: 400},
      {nome: "Piantina decorativa", prezzo: 150}
    ];
    
    oggettiInVendita.forEach((oggetto, index) => {
      console.log(`${index + 1}. ${oggetto.nome} - ${oggetto.prezzo} stelline`);
    });
    
    console.log("\nIl tuo saldo attuale: " + this.stato.giocatore.soldi + " stelline");
    console.log("Usa i numeri per acquistare (in una vera implementazione)");
  },

  arredaCasa() {
    console.log(`La tua casa Ã¨ al livello ${this.stato.giocatore.casa.livello}`);
    console.log("Arredamento attuale:");
    
    if (this.stato.giocatore.casa.arredamento.length === 0) {
      console.log("La tua casa Ã¨ vuota! Visita il negozio per comprare mobili.");
    } else {
      this.stato.giocatore.casa.arredamento.forEach((mobile, index) => {
        console.log(`${index + 1}. ${mobile}`);
      });
    }
    
    console.log("\nPuoi spostare i mobili o aggiungerne di nuovi dal tuo inventario.");
  },

  avanzaTempo() {
    this.stato.data.ora += 1;
    if (this.stato.data.ora >= 24) {
      this.stato.data.ora = 0;
      this.stato.data.giorno += 1;
      
      // Cambio stagione ogni 30 giorni
      if (this.stato.data.giorno > 30) {
        this.stato.data.giorno = 1;
        this.stato.data.mese += 1;
        
        if (this.stato.data.mese > 12) {
          this.stato.data.mese = 1;
        }
        
        // Aggiorna stagione
        const stagioni = ["Inverno", "Inverno", "Primavera", "Primavera", "Primavera", 
                         "Estate", "Estate", "Estate", "Autunno", "Autunno", "Autunno", "Inverno"];
        this.stato.data.stagione = stagioni[this.stato.data.mese - 1];
      }
      
      // Eventi giornalieri
      console.log("Ãˆ un nuovo giorno!");
      console.log(`Oggi Ã¨ un bel giorno di ${this.stato.data.stagione}.`);
      
      // Rigenerazione risorse
      console.log("Nuovi frutti sono cresciuti sugli alberi!");
      console.log("Nuovi pesci e insetti sono apparsi!");
    }
    
    console.log(`Ora attuale: ${this.stato.data.ora}:00`);
  },

  controllaStato() {
    console.log("\nðŸ“Š STATO DEL GIOCATORE ðŸ“Š");
    console.log(`Nome: ${this.stato.giocatore.nome}`);
    console.log(`Saldo: ${this.stato.giocatore.soldi} stelline`);
    console.log(`Livello casa: ${this.stato.giocatore.casa.livello}`);
    
    console.log("\nInventario:");
    if (this.stato.giocatore.inventario.length === 0) {
      console.log("Il tuo inventario Ã¨ vuoto!");
    } else {
      // Conta le occorrenze di ogni oggetto
      const conteggio = {};
      this.stato.giocatore.inventario.forEach(item => {
        conteggio[item] = (conteggio[item] || 0) + 1;
      });
      
      // Mostra l'inventario con conteggio
      for (const [item, count] of Object.entries(conteggio)) {
        console.log(`- ${item} x${count}`);
      }
    }
  }
};

// Per avviare il gioco
simulatoreIsola.inizia();
